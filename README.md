# Dashboard Backend

Бэкенд для MVP системы управления проектами и задачами внутри IT-команды.

---

## Описание

**Dashboard** — это REST API для управления проектами, задачами и ролями пользователей.
Реализована строгая ролевая модель, персональный дэшборд, real-time уведомления и удобный запуск.

---

## Функционал

- Регистрация и аутентификация пользователей (JWT)
- Гибкая система ролей: DEVELOPER, MANAGER, TEAM_LEAD, ADMIN
- Создание проектов (только MANAGER или TEAM_LEAD)
- Добавление/удаление участников проекта (только создатель)
- Создание задач внутри проектов и назначение их на других участников
- Изменение статуса и исполнителя задачи
- Персональный дэшборд: каждый пользователь видит только свои проекты и задачи
- Реализация real-time уведомлений через WebSocket (bonus)
- Согласованность данных: уведомления и действия атомарны, все данные хранятся в PostgreSQL

---

## Ролевая модель

- MANAGER/TEAM_LEAD — могут создавать проекты, управлять участниками, назначать задачи
- DEVELOPER — может видеть только свои проекты и задачи, менять статус только своих задач
- ADMIN — полный доступ (по умолчанию не используется для обычных операций)
- Доступ к проектам и задачам строго ограничен: пользователь видит только то, где он участник

---

## Технологии

- Node.js + NestJS
- PostgreSQL (через Prisma ORM)
- Swagger (автогенерация документации)
- WebSocket (реализация real-time уведомлений)

---

## Быстрый старт (локально)

1. Скопируйте `.env.example` и `.env.development.example` в `.env` и `.env.development`:

   ```bash
   cp .env.example .env
   cp .env.development.example .env.development
   ```

   Заполните переменные в этих файлах под свою среду.

2. Установите зависимости:

   ```bash
   npm install
   ```

3. Примените миграции:

   ```bash
   npx prisma migrate deploy
   ```

4. Запустите приложение:

   ```bash
   npm run start:dev
   ```

5. Приложение будет доступно:
   - API: http://localhost:6001
   - Swagger: http://localhost:6001/api
   - PostgreSQL: localhost:5432

---

## Основные эндпоинты

- `/auth/register` — регистрация пользователя
- `/auth/login` — аутентификация (JWT)
- `/projects` — CRUD проектов (создание только MANAGER/TEAM_LEAD)
- `/projects/:id/members` — управление участниками проекта
- `/tasks/project/:projectId` — создание задачи в проекте
- `/tasks/:id` — обновление/удаление задачи (создатель или исполнитель)
- `/tasks/my` — персональный дэшборд задач пользователя
- `/ws` — WebSocket для real-time уведомлений

---

## Реализация real-time (bonus)

- При изменении статуса задачи или назначении исполнителя, менеджер проекта получает уведомление мгновенно через WebSocket.
- Уведомления хранятся в базе и доступны после перезапуска.
- Система устойчива к сбоям и поддерживает согласованность данных.

---

## Как проверить real-time уведомления

1. Получите JWT токен через `/auth/login`.
2. Подключитесь к WebSocket (`ws://localhost:6001`) с помощью клиента (например, [websocat](https://github.com/vi/websocat) или браузерной утилиты).
3. Совершите действие (например, смените статус задачи через API).
4. Получите уведомление в реальном времени.

---

## Структура проекта

- `src/` — исходный код приложения
- `prisma/` — схема и миграции базы данных
- `.env`, `.env.development` — переменные окружения (см. `.env.example`, `.env.development.example`)

---

## Swagger-документация

Доступна по адресу:
[http://localhost:6001/api](http://localhost:6001/api)

---

## Примечания

- Все бизнес-правила и ограничения реализованы строго по ТЗ.
- Код покрыт типами, архитектура модульная, легко расширяется.
